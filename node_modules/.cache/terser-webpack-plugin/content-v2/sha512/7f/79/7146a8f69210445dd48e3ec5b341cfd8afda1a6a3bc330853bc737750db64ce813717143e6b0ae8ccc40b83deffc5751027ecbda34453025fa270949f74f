{"code":"!function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,\"a\",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=\"/var/folders/2p/gpg4ppl908s3565b98n_pj2m0000gn/T/_karma_webpack_/\",n(n.s=52)}({1:function(t,e,n){\"use strict\";n.r(e);var o={};n.r(o),n.d(o,\"sleep\",function(){return r}),n.d(o,\"waitUntilCondition\",function(){return s});var i=n(25);function r(t){return new Promise(e=>setTimeout(e,t))}function a({max_attempts:t=5,resolve:e,reject:n,interval:o,condition:i,onInterval:s,returnValue:u=(()=>!0)}){!function(t=1e3,e=(()=>{})){r(t).then(()=>{e()})}(o,()=>{i()?e(u()):(s(),--t<1&&n(\"max_attempts_threshold_reached\"),a({condition:i,interval:o,onInterval:s,resolve:e,returnValue:u}))})}function s({condition:t=(()=>!0),interval:e=100,max_attempts:n=5,onInterval:o=(()=>{}),returnValue:i=(()=>!0)}={}){return new Promise((r,s)=>{a({resolve:r,condition:t,interval:e,max_attempts:n,onInterval:o,returnValue:i,reject:s})})}n.d(e,\"MQTTX\",function(){return i.MQTTX}),n.d(e,\"Helpers\",function(){return o})},25:function(t,e){throw new Error(\"Module parse failed: Unexpected keyword 'true' (28:40)\\nYou may need an appropriate loader to handle this file type.\\n|   }\\n| \\n>   static publish(topic, data, {as_json: true, ...options}={}) {\\n|     if(as_json) {\\n|       this.client.publish(topic, JSON.stringify(data), {...options});\")},52:function(t,e,n){\"use strict\";n.r(e);var o=n(1);n(1);const{sleep:i}=o.Helpers;o.MQTTX.connect(\"wss://test.mosquitto.org:8081\"),describe(\"MQTTX\",function(){let t;beforeAll(async()=>{await i(500)}),describe(\"connect\",function(){it(\"proxies over to mqtt\",async function(){let e;t={one:\"two\"},o.MQTTX.on(\"mqttx/some/fake/topic/one\",(t,n)=>{e=t}),await i(300),o.MQTTX.client.publish(\"mqttx/some/fake/topic/one\",JSON.stringify(t)),await i(300),expect(e).toEqual(t)})}),describe(\"multiple_topics\",function(){it(\"handles callbacks individually\",async function(){let e,n;t={one:\"two\"},o.MQTTX.on(\"mqttx/multiple_topics/fake/topic/one\",(t,n)=>{e=t}),o.MQTTX.on(\"mqttx/multiple_topics/fake/topic/two\",(t,e)=>{n=t}),await i(300),o.MQTTX.client.publish(\"mqttx/multiple_topics/fake/topic/one\",JSON.stringify(t)),await i(300),expect(e).toEqual(t),expect(n).toEqual(void 0)})}),describe(\"one_time_subscription\",function(){it(\"disposes after called first time\",async function(){let e;t={one:\"two\"};let n=o.MQTTX.on(\"mqttx/one_time_subscription/fake/topic/one\",(t,n)=>{e=t},{is_one_time:!0});expect(n.is_one_time).toEqual(!0),expect(n.observable).not.toEqual(void 0),await i(300),o.MQTTX.client.publish(\"mqttx/one_time_subscription/fake/topic/one\",JSON.stringify(t)),await i(300),expect(e).toEqual(t),await i(300);o.MQTTX.client.publish(\"mqttx/one_time_subscription/fake/topic/one\",JSON.stringify({two:\"three\"})),expect(e).toEqual(t),expect(n.observable).toEqual(null)})}),describe(\"request\",function(){it(\"makes request/response\",async function(){t={one:\"two\"};await o.MQTTX.request(\"mqttx/user/123/events\");expect(subscription.is_one_time).toEqual(!0),expect(subscription.observable).not.toEqual(void 0),await i(300),o.MQTTX.client.publish(\"mqttx/one_time_subscription/fake/topic/one\",JSON.stringify(t)),await i(300),expect(void 0).toEqual(t),await i(300);o.MQTTX.client.publish(\"mqttx/one_time_subscription/fake/topic/one\",JSON.stringify({two:\"three\"})),expect(void 0).toEqual(t),expect(subscription.observable).toEqual(null)})})})}});","extractedComments":[]}